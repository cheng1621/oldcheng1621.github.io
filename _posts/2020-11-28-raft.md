---
layout: post
title:  "Raft note"
date: 2020-11-28 9:47:10 +0800
categories: [Distributed System]
tags: [Distributed System,Raft]
---
# Why Raft?
Paxos can provide correctness and safety, it is capable of reaching agreement on a single decision. However, it is difficult to understand and it does not provide a good foundation for implementations. (a bad foundation can cause developer waste time on debugging.)

# Goals:
1. understandability.  
    developer can make an extension to algorithm after fully understanding them.
2. 

# Raft consensus algorithm.
1. Raft basics.  
![Server State](https://raw.githubusercontent.com/cheng1621/HelloMike.github.io/master/assets/img/sample/Server_State.png)
**Follower**    only receives request from Leader.
**Candidate**   if no leader in the term, follower could become Candidate
**Leader**      Control the follower.

2. Log replication. (5.3 Log entries)
summary:
* A log is committed: entry has been replicated on a majority of servers.
* leader could respond to client before follower store its log entries.
* if two log entries have same index and term, these two entries have the same command and identical previous log entries.
* consistency check:
Normally, logs of Leader and Follower should stay consistent.
To preserve **Log Matching Property**:(if leader crashes for some predicted reasons)
* forcing followers to duplicate the leader's logs.
    find the latest log in which followers and leader are same, delete log entries after it and duplicate leader's log entries to it.

3. Safety. (5.4 Safety)
problem: the previous section cannot guarantee all servers execute same command in the same order.
> Raft uses the voting process to prevent a candidate from winning an election unless its log contains all committed entries.



